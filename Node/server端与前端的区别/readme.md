## server端与client端的关系

![在这里插入图片描述](https://img-blog.csdnimg.cn/20200628180941120.png)

这里的server可能不只是一个服务器，而是一个集群。

前端代码通过server端下载到本地（客户端），然后通过浏览器解析执行。一个client端对应一个server端。

server端需要处理很多client端的请求。

## server端开发与前端开发的区别
server端需要具有：
### 1. 服务稳定性
   - 由于多个客户端共用一个服务端，所以服务端必须具有稳定性。不能随便挂掉。单个客户端可以意外挂掉，但服务端不能
   - 由于服务端的接口暴露在整个互联网之下，服务端可能会遭受各种恶意攻击和误操作
  
PM2进程守候

- 进程守护，系统崩溃自动重启
- 自带日志记录功能
- 启动多进程，充分利用CPU和内存

PM2常用指令：
- `pm2 start`
- `pm2 restart <name>/<id>`
- `pm2 stop <name>/<id>`
- `pm2 delete <name>/<id>`
- `pm2 info <name>/<id>`
- `pm2 log <name>/<id>`    查看日志记录
- `pm2 monit <name>/<id>`  查看内存和CPU占用

多进程: 
充分利用CPU和内存
多核CPU同时处理多个进程的优势
内存不共享，用redis解决

### 2. 考虑内存和CPU（优化、扩展）
   - 客户端独占一个浏览器，内存和CPU都很充足
   - server端要承载很多请求，CPU和内存都是稀缺资源

stream写日志（优化），redis存session（扩展）。

### 3. 日志记录
   - 前端也会参与写日志，但只是日志的发起方，并不关心后续
   - server端所有的运行状态都要靠日志监控，server端要记录日志、存储日志、分析日志，而前端并不关心这些

### 4. 安全性
   - server端要随时准备接受各种恶意攻击，是安全的最后保障
   - 如越权操作，数据库攻击等
  
登录校验、密码加密、预防xss攻击和sql注入。

### 5. 集群和服务拆分
   - 产品发展速度快，流量迅速增加，server端承载压力过大时需要做集群和服务拆分。

扩展机器和服务拆分。
